!function(){"use strict";var e=window.wp.blocks,t=window.wp.element,n=window.wp.i18n,i=window.wp.htmlEntities,l=window.wp.escapeHtml,a=window.wp.blockEditor,o=window.wp.data,r=window.wp.url,c=window.wp.components,s=window.wp.blob,u=window.React,m=window.wp.primitives,d=(0,u.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,u.createElement)(m.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z"})),p=window.wp.notices;const w=e=>null==e||""===e,E=e=>{var t=document.createElement("textarea");return t.innerHTML=e,t.value},g=e=>{let t=document.createElement("div");return t.innerHTML=E(e),t.innerText};var h=function({url:e="",caption:i="",alt:l="",setURLCaption:r}){const u=["image"],[m,E]=(0,t.useState)(null),[g,h]=(0,t.useState)(),{imageDefaultSize:f,mediaUpload:x}=((0,t.useRef)(),(0,o.useSelect)((e=>{const{getSettings:t}=e(a.store),n=t();return{imageDefaultSize:n.imageDefaultSize,mediaUpload:n.mediaUpload}}),[])),{createErrorNotice:v}=(0,o.useDispatch)(p.store);function _(e){v(e,{type:"snackbar"}),r(void 0,void 0),h(void 0)}function q(e){if(!e||!e.url)return void r(void 0,void 0);if((0,s.isBlobURL)(e.url))return void h(e.url);h();let t=((e,t)=>{const n=Object.fromEntries(Object.entries(null!=e?e:{}).filter((([e])=>["alt","id","link","caption"].includes(e))));return n.url=e?.sizes?.[t]?.url||e?.media_details?.sizes?.[t]?.source_url||e.url,n})(e,f);E(t.id),r(t.url,t.caption)}function b(t){t!==e&&r(t,i)}let z=((e,t)=>!e&&(0,s.isBlobURL)(t))(m,e);(0,t.useEffect)((()=>{if(!z)return;const t=(0,s.getBlobByURL)(e);t&&x({filesList:[t],onFileChange:([e])=>{q(e)},allowedTypes:u,onError:e=>{z=!1,_(e)}})}),[]),(0,t.useEffect)((()=>{z?h(e):(0,s.revokeBlobURL)(g)}),[z,e]);const L=((e,t)=>t&&!e&&!(0,s.isBlobURL)(t))(m,e)?e:void 0,R=!!e&&(0,t.createElement)("img",{alt:(0,n.__)("Edit image"),title:(0,n.__)("Edit image"),className:"edit-image-preview",src:e});let k=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("img",{src:g||e,alt:"",className:"qsm-answer-option-image",style:{width:"200",height:"auto"}}),g&&(0,t.createElement)(c.Spinner,null));return(0,t.createElement)("figure",null,w(e)?(0,t.createElement)(a.MediaPlaceholder,{icon:(0,t.createElement)(a.BlockIcon,{icon:d}),onSelect:q,onSelectURL:b,onError:_,accept:"image/*",allowedTypes:u,value:{id:m,src:L},mediaPreview:R,disableMediaButtons:g||e}):(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.BlockControls,{group:"other"},(0,t.createElement)(a.MediaReplaceFlow,{mediaId:m,mediaURL:e,allowedTypes:u,accept:"image/*",onSelect:q,onSelectURL:b,onError:_})),(0,t.createElement)("div",null,k)))},f=JSON.parse('{"u2":"qsm/quiz-answer-option"}');(0,e.registerBlockType)(f.u2,{icon:()=>(0,t.createElement)(c.Icon,{icon:()=>(0,t.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("rect",{width:"24",height:"24",rx:"3",fill:"#EEEEEE"}),(0,t.createElement)("path",{d:"M16 14.3958L16 15.7887L8.63636 15.7887L7 14.3958L16 14.3958Z",fill:"black"}),(0,t.createElement)("path",{d:"M12.552 6H14.052L17.552 19H16.052L12.552 6Z",fill:"black"}),(0,t.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.4583 6H12.9583L11.0916 12.9333H9.59158L11.4583 6ZM9.12492 14.6667L7.95825 19H9.45825L10.6249 14.6667H9.12492Z",fill:"black"}))}),merge(e,t){return{content:(e.content||"")+(t.content||"")}},edit:function(s){if("undefined"==typeof qsmBlockData)return null;const{className:u,attributes:m,setAttributes:d,isSelected:p,clientId:f,context:x,mergeBlocks:v,onReplace:_,onRemove:q}=s,b=(x["quiz-master-next/quizID"],x["quiz-master-next/pageID"],x["quiz-master-next/questionID"],x["quiz-master-next/questionType"]),z=x["quiz-master-next/answerType"],L=x["quiz-master-next/questionChanged"],R="qsm/quiz-answer-option",{optionID:k,content:B,caption:S,points:C,isCorrect:y}=m,{selectBlock:U}=(0,o.useDispatch)(a.store),{updateBlockAttributes:T}=(0,o.useDispatch)(a.store),I=(0,o.useSelect)((e=>{let t=e(a.store).getBlockParentsByBlockName(f,"qsm/quiz-question",!0);return w(t)?"":t[0]}),[f]);(0,t.useEffect)((()=>{let e=!0;return e&&p&&!w(I)&&!1===L&&T(I,{isChanged:!0}),()=>{e=!1}}),[B,S,C,y]),(0,t.useEffect)((()=>{let e=!0;return e&&(w(B)||!(0,r.isURL)(B)||-1===B.indexOf("https://")&&-1===B.indexOf("http://")||!["rich","text"].includes(z)||d({content:"",caption:""})),()=>{e=!1}}),[z]);const M=(0,a.useBlockProps)({className:""}),H=["4","10"].includes(b)?"checkbox":"radio";return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.InspectorControls,null,(0,t.createElement)(c.PanelBody,{title:(0,n.__)("Settings","quiz-master-next"),initialOpen:!0},"image"===z&&(0,t.createElement)(c.TextControl,{type:"text",label:(0,n.__)("Caption","quiz-master-next"),value:S,onChange:e=>d({caption:(0,l.escapeAttribute)(e)})}),(0,t.createElement)(c.TextControl,{type:"number",label:(0,n.__)("Points","quiz-master-next"),help:(0,n.__)("Answer points","quiz-master-next"),value:C,onChange:e=>d({points:e})}),["0","4","1","10","2"].includes(b)&&(0,t.createElement)(c.ToggleControl,{label:(0,n.__)("Correct","quiz-master-next"),checked:!w(y)&&"1"==y,onChange:()=>d({isCorrect:w(y)||"1"!=y?1:0})}))),(0,t.createElement)("div",{...M},(0,t.createElement)(c.__experimentalHStack,{className:"edit-post-document-actions__title",spacing:1,justify:"left"},(0,t.createElement)("input",{type:H,readOnly:!0,tabIndex:"-1"}),!["rich","image"].includes(z)&&(0,t.createElement)(a.RichText,{tagName:"p",title:(0,n.__)("Answer options","quiz-master-next"),"aria-label":(0,n.__)("Question answer","quiz-master-next"),placeholder:(0,n.__)("Your Answer","quiz-master-next"),value:g((0,i.decodeEntities)(B)),onChange:e=>d({content:g((0,i.decodeEntities)(e))}),onSplit:(t,n)=>{let i;(n||t)&&(i={...m,content:t});const l=(0,e.createBlock)(R,i);return n&&(l.clientId=f),l},onMerge:v,onReplace:_,onRemove:q,allowedFormats:[],withoutInteractiveFormatting:!0,className:"qsm-question-answer-option",identifier:"text"}),"rich"===z&&(0,t.createElement)(a.RichText,{tagName:"p",title:(0,n.__)("Answer options","quiz-master-next"),"aria-label":(0,n.__)("Question answer","quiz-master-next"),placeholder:(0,n.__)("Your Answer","quiz-master-next"),value:E((0,i.decodeEntities)(B)),onChange:e=>d({content:e}),onSplit:(t,n)=>{let i;(n||t)&&(i={...m,content:t});const l=(0,e.createBlock)(R,i);return n&&(l.clientId=f),l},onMerge:v,onReplace:_,onRemove:q,className:"qsm-question-answer-option",identifier:"text",__unstableEmbedURLOnPaste:!0,__unstableAllowPrefixTransformations:!0}),"image"===z&&(0,t.createElement)(h,{url:(0,r.isURL)(B)?B:"",caption:S,setURLCaption:(e,t)=>d({content:(0,r.isURL)(e)?e:"",caption:t})}))))}})}();