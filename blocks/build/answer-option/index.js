!function(){"use strict";var e=window.wp.blocks,t=window.wp.element,n=window.wp.i18n,i=window.wp.htmlEntities,o=window.wp.escapeHtml,a=window.wp.blockEditor,r=window.wp.data,l=window.wp.url,s=window.wp.components,c=window.wp.blob,u=window.React,m=window.wp.primitives,d=(0,u.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,u.createElement)(m.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z"})),p=window.wp.notices;const w=e=>null==e||""===e,g=e=>{var t=document.createElement("textarea");return t.innerHTML=e,t.value},E=e=>{let t=document.createElement("div");return t.innerHTML=g(e),t.innerText};var f=function({url:e="",caption:i="",alt:o="",setURLCaption:l}){const u=["image"],[m,g]=(0,t.useState)(null),[E,f]=(0,t.useState)(),{imageDefaultSize:x,mediaUpload:_}=((0,t.useRef)(),(0,r.useSelect)((e=>{const{getSettings:t}=e(a.store),n=t();return{imageDefaultSize:n.imageDefaultSize,mediaUpload:n.mediaUpload}}),[])),{createErrorNotice:h}=(0,r.useDispatch)(p.store);function q(e){h(e,{type:"snackbar"}),l(void 0,void 0),f(void 0)}function v(e){if(!e||!e.url)return void l(void 0,void 0);if((0,c.isBlobURL)(e.url))return void f(e.url);f();let t=((e,t)=>{const n=Object.fromEntries(Object.entries(null!=e?e:{}).filter((([e])=>["alt","id","link","caption"].includes(e))));return n.url=e?.sizes?.[t]?.url||e?.media_details?.sizes?.[t]?.source_url||e.url,n})(e,x);g(t.id),l(t.url,t.caption)}function z(t){t!==e&&l(t,i)}let b=((e,t)=>!e&&(0,c.isBlobURL)(t))(m,e);(0,t.useEffect)((()=>{if(!b)return;const t=(0,c.getBlobByURL)(e);t&&_({filesList:[t],onFileChange:([e])=>{v(e)},allowedTypes:u,onError:e=>{b=!1,q(e)}})}),[]),(0,t.useEffect)((()=>{b?f(e):(0,c.revokeBlobURL)(E)}),[b,e]);const R=((e,t)=>t&&!e&&!(0,c.isBlobURL)(t))(m,e)?e:void 0,B=!!e&&(0,t.createElement)("img",{alt:(0,n.__)("Edit image"),title:(0,n.__)("Edit image"),className:"edit-image-preview",src:e});let k=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("img",{src:E||e,alt:"",className:"qsm-answer-option-image",style:{width:"200",height:"auto"}}),E&&(0,t.createElement)(s.Spinner,null));return(0,t.createElement)("figure",null,w(e)?(0,t.createElement)(a.MediaPlaceholder,{icon:(0,t.createElement)(a.BlockIcon,{icon:d}),onSelect:v,onSelectURL:z,onError:q,accept:"image/*",allowedTypes:u,value:{id:m,src:R},mediaPreview:B,disableMediaButtons:E||e}):(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.BlockControls,{group:"other"},(0,t.createElement)(a.MediaReplaceFlow,{mediaId:m,mediaURL:e,allowedTypes:u,accept:"image/*",onSelect:v,onSelectURL:z,onError:q})),(0,t.createElement)("div",null,k)))},x=JSON.parse('{"u2":"qsm/quiz-answer-option"}');(0,e.registerBlockType)(x.u2,{merge(e,t){return{content:(e.content||"")+(t.content||"")}},edit:function(c){if("undefined"==typeof qsmBlockData)return null;const{className:u,attributes:m,setAttributes:d,isSelected:p,clientId:x,context:_,mergeBlocks:h,onReplace:q,onRemove:v}=c,z=(_["quiz-master-next/quizID"],_["quiz-master-next/pageID"],_["quiz-master-next/questionID"],_["quiz-master-next/questionType"]),b=_["quiz-master-next/answerType"],R=_["quiz-master-next/questionChanged"],B="qsm/quiz-answer-option",{optionID:k,content:S,caption:C,points:L,isCorrect:y}=m,{selectBlock:U}=(0,r.useDispatch)(a.store),{updateBlockAttributes:T}=(0,r.useDispatch)(a.store),I=(0,r.useSelect)((e=>{let t=e(a.store).getBlockParentsByBlockName(x,"qsm/quiz-question",!0);return w(t)?"":t[0]}),[x]);(0,t.useEffect)((()=>{let e=!0;return e&&p&&!w(I)&&!1===R&&T(I,{isChanged:!0}),()=>{e=!1}}),[S,C,L,y]),(0,t.useEffect)((()=>{let e=!0;return e&&(w(S)||!(0,l.isURL)(S)||-1===S.indexOf("https://")&&-1===S.indexOf("http://")||!["rich","text"].includes(b)||d({content:"",caption:""})),()=>{e=!1}}),[b]);const N=(0,a.useBlockProps)({className:""}),D=["4","10"].includes(z)?"checkbox":"radio";return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.InspectorControls,null,(0,t.createElement)(s.PanelBody,{title:(0,n.__)("Settings","quiz-master-next"),initialOpen:!0},"image"===b&&(0,t.createElement)(s.TextControl,{type:"text",label:(0,n.__)("Caption","quiz-master-next"),value:C,onChange:e=>d({caption:(0,o.escapeAttribute)(e)})}),(0,t.createElement)(s.TextControl,{type:"number",label:(0,n.__)("Points","quiz-master-next"),help:(0,n.__)("Answer points","quiz-master-next"),value:L,onChange:e=>d({points:e})}),["0","4","1","10","2"].includes(z)&&(0,t.createElement)(s.ToggleControl,{label:(0,n.__)("Correct","quiz-master-next"),checked:!w(y)&&"1"==y,onChange:()=>d({isCorrect:w(y)||"1"!=y?1:0})}))),(0,t.createElement)("div",{...N},(0,t.createElement)(s.__experimentalHStack,{className:"edit-post-document-actions__title",spacing:1,justify:"left"},(0,t.createElement)("input",{type:D,readOnly:!0,tabIndex:"-1"}),!["rich","image"].includes(b)&&(0,t.createElement)(a.RichText,{tagName:"p",title:(0,n.__)("Answer options","quiz-master-next"),"aria-label":(0,n.__)("Question answer","quiz-master-next"),placeholder:(0,n.__)("Your Answer","quiz-master-next"),value:E((0,i.decodeEntities)(S)),onChange:e=>d({content:E((0,i.decodeEntities)(e))}),onSplit:(t,n)=>{let i;(n||t)&&(i={...m,content:t});const o=(0,e.createBlock)(B,i);return n&&(o.clientId=x),o},onMerge:h,onReplace:q,onRemove:v,allowedFormats:[],withoutInteractiveFormatting:!0,className:"qsm-question-answer-option",identifier:"text"}),"rich"===b&&(0,t.createElement)(a.RichText,{tagName:"p",title:(0,n.__)("Answer options","quiz-master-next"),"aria-label":(0,n.__)("Question answer","quiz-master-next"),placeholder:(0,n.__)("Your Answer","quiz-master-next"),value:g((0,i.decodeEntities)(S)),onChange:e=>d({content:e}),onSplit:(t,n)=>{let i;(n||t)&&(i={...m,content:t});const o=(0,e.createBlock)(B,i);return n&&(o.clientId=x),o},onMerge:h,onReplace:q,onRemove:v,className:"qsm-question-answer-option",identifier:"text",__unstableEmbedURLOnPaste:!0,__unstableAllowPrefixTransformations:!0}),"image"===b&&(0,t.createElement)(f,{url:(0,l.isURL)(S)?S:"",caption:C,setURLCaption:(e,t)=>d({content:(0,l.isURL)(e)?e:"",caption:t})}))))}})}();