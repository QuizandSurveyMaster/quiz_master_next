!function(){"use strict";var e,t={775:function(e,t,n){var i=window.wp.blocks,a=window.wp.element,s=window.wp.i18n,r=window.wp.apiFetch,o=n.n(r),l=window.wp.htmlEntities,u=window.wp.blockEditor,c=window.wp.notices,m=window.wp.data,p=window.wp.editor,q=window.wp.components;const d=e=>null==e||""===e,_=e=>{var t=document.createElement("textarea");return t.innerHTML=e,t.value},g=(e=!1)=>{let t=new FormData;if(t.append("qsm_block_api_call","1"),!1!==e)for(let n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);return t},h=(e,t="")=>d(e)?t:e;(0,i.registerBlockType)("qsm/quiz",{icon:()=>(0,a.createElement)(q.Icon,{icon:()=>(0,a.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("rect",{width:"24",height:"24",rx:"3",fill:"#EEEEEE"}),(0,a.createElement)("path",{d:"M9.00508 11.5025C9.00508 9.5736 7.44162 8 5.50254 8C3.56345 8 2 9.56345 2 11.5025C2 13.269 3.29949 14.731 5.00508 14.9645V14.132C3.7665 13.8985 2.83249 12.8122 2.83249 11.5025C2.82234 10.0203 4.0203 8.82233 5.50254 8.82233C6.98477 8.82233 8.18274 10.0203 8.18274 11.5025C8.18274 12.6599 7.45178 13.6447 6.4264 14.0102V13.1675H5.51269V16H6.4264V14.8629C7.90863 14.4569 9.01523 13.1066 9.01523 11.4924L9.00508 11.5025Z",fill:"black",stroke:"black",strokeWidth:"0.5"}),(0,a.createElement)("path",{d:"M15.3097 9.13702L14.995 15.1878H15.8681L16.0711 11.2487C16.1016 10.599 16.1117 10.1319 16.1016 9.83753C16.0001 9.49235 15.6041 9.14718 15.3097 9.13702Z",fill:"black",stroke:"black",strokeWidth:"0.5"}),(0,a.createElement)("path",{d:"M21.9593 8.30451C21.472 8.06085 20.9847 8.20298 20.7309 8.33496L19.2385 12.2842C19.1471 12.5279 19.0659 12.7614 18.9948 12.9644C18.9238 13.1675 18.8629 13.3502 18.8121 13.5126C18.7512 13.6954 18.7004 13.8578 18.6598 14.0202H18.6395C18.5887 13.868 18.538 13.6954 18.4669 13.5126C18.4162 13.3502 18.3451 13.1675 18.274 12.9644C18.203 12.7512 18.1217 12.5279 18.0304 12.2842L16.6903 8.64968C16.3857 8.16238 15.8679 8.0304 15.604 8.0304H15.3603H11.8172C11.8172 8.0304 11.7563 8.0304 11.7156 8.0304C11.3908 8.0507 11.1065 8.09131 10.8629 8.17253C10.5786 8.27405 10.3451 8.40603 10.1623 8.56847C9.98976 8.7309 9.85778 8.9238 9.78671 9.12684C9.71564 9.32989 9.67503 9.55324 9.67503 9.76644C9.67503 10.1421 9.76641 10.4568 9.93899 10.7106C10.1217 10.9644 10.3451 11.1776 10.609 11.3603C10.873 11.5431 11.1674 11.7055 11.4821 11.8477C11.807 11.9898 12.1014 12.1421 12.3755 12.2944C12.6598 12.4466 12.873 12.6091 13.0354 12.7715C13.208 12.9339 13.2994 13.1471 13.2994 13.4111C13.2994 13.5837 13.2486 13.736 13.1573 13.8578C13.0659 13.9796 12.9441 14.0812 12.7816 14.1522C12.6192 14.2233 12.4263 14.2842 12.203 14.3147C12.142 14.3147 12.0913 14.335 12.0304 14.335L8.24356 14.3248C7.96945 14.5989 7.34001 15.1471 7.01514 15.1471H12.0202C12.1319 15.1471 12.2537 15.137 12.3654 15.1167C12.6903 15.0659 12.9745 14.9746 13.2486 14.8426C13.5126 14.7106 13.7359 14.5177 13.8984 14.2741C14.071 14.0304 14.1623 13.7055 14.1623 13.2994C14.1623 12.9543 14.071 12.6598 13.8882 12.4162C13.7156 12.1725 13.4923 11.9593 13.2283 11.7867C12.9644 11.604 12.67 11.4416 12.3451 11.3096C12.0304 11.1675 11.7461 11.0253 11.472 10.8832C11.208 10.7309 10.9847 10.5685 10.8121 10.406C10.6395 10.2334 10.538 10.0101 10.538 9.76644C10.538 9.44156 10.6497 9.20806 10.8629 9.06593C11.0456 8.93395 11.3502 8.86288 11.7461 8.84258H15.3197C15.7766 8.88319 16.0202 9.1776 16.1116 9.35019C16.1116 9.38065 16.1319 9.42126 16.142 9.45172C16.1725 9.54309 16.203 9.65476 16.2436 9.77659C16.2943 9.92887 16.3654 10.1319 16.4466 10.3756C16.5278 10.6091 16.6293 10.9035 16.7613 11.2385L18.2131 15.1776H19.0862L20.5278 11.2385C20.6497 10.8933 20.7512 10.6091 20.8324 10.3654C20.9238 10.1218 20.9948 9.91872 21.0456 9.76644C21.1065 9.5837 21.1573 9.44156 21.1979 9.34004H21.2182V9.77659C21.2182 9.92887 21.2182 10.1218 21.2283 10.3654C21.2283 10.5989 21.2486 10.8933 21.2588 11.2385L21.4314 15.1776H22.3045L21.9593 8.30451Z",fill:"black",stroke:"black",strokeWidth:"0.5"}))}),edit:function(e){if("undefined"==typeof qsmBlockData)return null;const{className:t,attributes:n,setAttributes:i,isSelected:r,clientId:f}=e,{createNotice:z}=(0,m.useDispatch)(c.store),C=qsmBlockData.globalQuizsetting,{quizID:w,quizAttr:b=C}=n,[v,y]=(0,a.useState)(qsmBlockData.QSMQuizList),[k,E]=(0,a.useState)({error:!1,msg:""}),[D,I]=(0,a.useState)(!1),[B,x]=(0,a.useState)(!1),[S,O]=(0,a.useState)(!1),[P,H]=(0,a.useState)([]),M=qsmBlockData.quizOptions,T=(0,m.useSelect)((e=>{const{isAutosavingPost:t,isSavingPost:n}=e(p.store);return n()&&!t()}),[]),{getBlock:A}=(0,m.useSelect)(u.store);(0,a.useEffect)((()=>{let e=!0;return e&&("0"==qsmBlockData.is_pro_activated&&setTimeout((()=>{L()}),100),!d(w)&&0<w&&N(w)),()=>{e=!1}}),[]);const L=()=>{let e=document.getElementById("modal-advanced-question-type");d(e)&&o()({path:"/quiz-survey-master/v1/quiz/advance-ques-type-upgrade-popup",method:"POST"}).then((e=>{let t=document.getElementById("wpbody-content");d(t)||"success"!=e.status||t.insertAdjacentHTML("afterbegin",e.result)})).catch((e=>{console.log("error",e)}))},N=e=>{!d(e)&&0<e&&o()({path:"/quiz-survey-master/v1/quiz/structure",method:"POST",data:{quizID:e}}).then((t=>{if("success"==t.status){let n=t.result;if(i({quizID:parseInt(e),quizAttr:{...b,...n}}),!d(n.qpages)){let e=[];n.qpages.forEach((t=>{let n=[];d(t.question_arr)||t.question_arr.forEach((e=>{if(!d(e)){let t=[];!d(e.answers)&&0<e.answers.length&&e.answers.forEach(((e,n)=>{t.push(["qsm/quiz-answer-option",{optionID:n,content:e[0],points:e[1],isCorrect:e[2],caption:h(e[3])}])})),n.push(["qsm/quiz-question",{questionID:e.question_id,type:e.question_type_new,answerEditor:e.settings.answerEditor,title:e.settings.question_title,description:e.question_name,required:e.settings.required,hint:e.hints,answers:e.answers,correctAnswerInfo:e.question_answer_info,category:e.category,multicategories:e.multicategories,commentBox:e.comments,matchAnswer:e.settings.matchAnswer,featureImageID:e.settings.featureImageID,featureImageSrc:e.settings.featureImageSrc,settings:e.settings},t])}})),e.push(["qsm/quiz-page",{pageID:t.id,pageKey:t.pagekey,hidePrevBtn:t.hide_prevbtn,quizID:t.quizID},n])})),H(e)}}else console.log("error "+t.msg)})).catch((e=>{console.log("error",e)}))},Q=(e,t)=>{let n=b;n[t]=e,i({quizAttr:{...n}})};(0,a.useEffect)((()=>{if(T){let e=(()=>{let e=A(f);if(d(e))return!1;e=e.innerBlocks;let t={quiz_id:b.quiz_id,post_id:b.post_id,quiz:{},pages:[],qpages:[],questions:[]},n=0;return e.forEach((e=>{if("qsm/quiz-page"===e.name){let i=e.attributes.pageID,a=[];!d(e.innerBlocks)&&0<e.innerBlocks.length&&e.innerBlocks.forEach((e=>{if("qsm/quiz-question"!==e.name)return!0;let i=e.attributes,s=h(i?.answerEditor,"text"),r=[];!d(e.innerBlocks)&&0<e.innerBlocks.length&&e.innerBlocks.forEach((e=>{if("qsm/quiz-answer-option"!==e.name)return!0;let t=e.attributes,n=h(t?.content);d(i?.answerEditor)||"rich"!==i.answerEditor||(n=_((0,l.decodeEntities)(n)));let a=[n,h(t?.points),h(t?.isCorrect)];"image"!==s||d(t?.caption)||a.push(t?.caption),r.push(a)})),a.push(i.questionID),i.isChanged&&t.questions.push({id:i.questionID,quizID:b.quiz_id,postID:b.post_id,answerEditor:s,type:h(i?.type,"0"),name:_(h(i?.description)),question_title:h(i?.title),answerInfo:_(h(i?.correctAnswerInfo)),comments:h(i?.commentBox,"1"),hint:h(i?.hint),category:h(i?.category),multicategories:h(i?.multicategories,[]),required:h(i?.required,1),answers:r,featureImageID:h(i?.featureImageID),featureImageSrc:h(i?.featureImageSrc),page:n})})),t.pages.push(a),t.qpages.push({id:i,quizID:b.quiz_id,pagekey:e.attributes.pageKey,hide_prevbtn:e.attributes.hidePrevBtn,questions:a}),n++}})),t.quiz={quiz_name:b.quiz_name,quiz_id:b.quiz_id,post_id:b.post_id},S&&["form_type","system","timer_limit","pagination","enable_contact_form","enable_pagination_quiz","show_question_featured_image_in_result","progress_bar","require_log_in","disable_first_page","comment_section"].forEach((e=>{void 0!==b[e]&&null!==b[e]&&(t.quiz[e]=b[e])})),t})();x(!0),e=g({save_entire_quiz:"1",quizData:JSON.stringify(e),qsm_block_quiz_nonce:qsmBlockData.nonce,nonce:qsmBlockData.saveNonce}),o()({path:"/quiz-survey-master/v1/quiz/save_quiz",method:"POST",body:e}).then((e=>{z(e.status,e.msg,{isDismissible:!0,type:"snackbar"})})).catch((e=>{console.log("error",e),z("error",e.message,{isDismissible:!0,type:"snackbar"})}))}}),[T]);const j=(0,u.useBlockProps)(),V=(0,u.useInnerBlocksProps)(j,{template:P,allowedBlocks:["qsm/quiz-page"]});return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(u.InspectorControls,null,(0,a.createElement)(q.PanelBody,{title:(0,s.__)("Quiz settings","quiz-master-next"),initialOpen:!0},(0,a.createElement)(q.TextControl,{label:(0,s.__)("Quiz Name *","quiz-master-next"),help:(0,s.__)("Enter a name for this Quiz","quiz-master-next"),value:b?.quiz_name||"",onChange:e=>Q(e,"quiz_name")}))),d(w)||"0"==w?(0,a.createElement)(q.Placeholder,{icon:()=>(0,a.createElement)(q.Icon,{icon:"vault",size:"36"}),label:(0,s.__)("Quiz And Survey Master","quiz-master-next"),instructions:(0,s.__)("Easily and quickly add quizzes and surveys inside the block editor.","quiz-master-next")},(0,a.createElement)(a.Fragment,null,!d(v)&&0<v.length&&(0,a.createElement)("div",{className:"qsm-placeholder-select-create-quiz"},(0,a.createElement)(q.SelectControl,{label:(0,s.__)("","quiz-master-next"),value:w,options:v,onChange:e=>N(e),disabled:D,__nextHasNoMarginBottom:!0}),(0,a.createElement)("span",null,(0,s.__)("OR","quiz-master-next")),(0,a.createElement)(q.Button,{variant:"link",onClick:()=>I(!D)},(0,s.__)("Add New","quiz-master-next"))),(d(v)||D)&&(0,a.createElement)(q.__experimentalVStack,{spacing:"3",className:"qsm-placeholder-quiz-create-form"},(0,a.createElement)(q.TextControl,{label:(0,s.__)("Quiz Name *","quiz-master-next"),help:(0,s.__)("Enter a name for this Quiz","quiz-master-next"),value:b?.quiz_name||"",onChange:e=>Q(e,"quiz_name")}),(0,a.createElement)(q.Button,{variant:"link",onClick:()=>O(!S)},(0,s.__)("Advance options","quiz-master-next")),S&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(q.SelectControl,{label:M?.form_type?.label,value:b?.form_type,options:M?.form_type?.options,onChange:e=>Q(e,"form_type"),__nextHasNoMarginBottom:!0}),(0,a.createElement)(q.SelectControl,{label:M?.system?.label,value:b?.system,options:M?.system?.options,onChange:e=>Q(e,"system"),help:M?.system?.help,__nextHasNoMarginBottom:!0}),["timer_limit","pagination"].map((e=>(0,a.createElement)(q.TextControl,{key:"quiz-create-text-"+e,type:"number",label:M?.[e]?.label,help:M?.[e]?.help,value:d(b[e])?0:b[e],onChange:t=>Q(t,e)}))),["enable_contact_form","enable_pagination_quiz","show_question_featured_image_in_result","progress_bar","require_log_in","disable_first_page","comment_section"].map((e=>(0,a.createElement)(q.ToggleControl,{key:"quiz-create-toggle-"+e,label:M?.[e]?.label,help:M?.[e]?.help,checked:!d(b[e])&&"1"==b[e],onChange:()=>Q(d(b[e])||"1"!=b[e]?1:0,e)})))),(0,a.createElement)(q.Button,{variant:"primary",disabled:B||d(b.quiz_name),onClick:()=>(()=>{if(d(b.quiz_name))return void console.log("empty quiz_name");x(!0);let e=g({quiz_name:b.quiz_name,qsm_new_quiz_nonce:qsmBlockData.qsm_new_quiz_nonce});["form_type","system","timer_limit","pagination","enable_contact_form","enable_pagination_quiz","show_question_featured_image_in_result","progress_bar","require_log_in","disable_first_page","comment_section"].forEach((t=>void 0===b[t]||null===b[t]?"":e.append(t,b[t]))),o()({path:"/quiz-survey-master/v1/quiz/create_quiz",method:"POST",body:e}).then((e=>{if(x(!1),"success"==e.status){let t=g({id:null,quizID:e.quizID,answerEditor:"text",type:"0",name:"",question_title:"",answerInfo:"",comments:"1",hint:"",category:"",required:1,answers:[],page:0});o()({path:"/quiz-survey-master/v1/questions",method:"POST",body:t}).then((t=>{if("success"==t.status){let n=t.id,i=g({action:qsmBlockData.save_pages_action,quiz_id:e.quizID,nonce:qsmBlockData.saveNonce,post_id:e.quizPostID});i.append("pages[0][]",n),i.append("qpages[0][id]",1),i.append("qpages[0][quizID]",e.quizID),i.append("qpages[0][pagekey]",((e="",t=!1)=>`${e}${(1e3*Date.now()+1e3*Math.random()).toString(16).replace(/\./g,"").padEnd(8,"0")}${t?`.${Math.trunc(1e8*Math.random())}`:""}`)()),i.append("qpages[0][hide_prevbtn]",0),i.append("qpages[0][questions][]",n),o()({url:qsmBlockData.ajax_url,method:"POST",body:i}).then((t=>{"success"==t.status&&N(e.quizID)}))}})).catch((e=>{console.log("error",e),z("error",e.message,{isDismissible:!0,type:"snackbar"})}))}z(e.status,e.msg,{isDismissible:!0,type:"snackbar"})})).catch((e=>{console.log("error",e),z("error",e.message,{isDismissible:!0,type:"snackbar"})}))})()},(0,s.__)("Create Quiz","quiz-master-next"))))):(0,a.createElement)("div",{...V}))},save:e=>null})}},n={};function i(e){var a=n[e];if(void 0!==a)return a.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,i),s.exports}i.m=t,e=[],i.O=function(t,n,a,s){if(!n){var r=1/0;for(c=0;c<e.length;c++){n=e[c][0],a=e[c][1],s=e[c][2];for(var o=!0,l=0;l<n.length;l++)(!1&s||r>=s)&&Object.keys(i.O).every((function(e){return i.O[e](n[l])}))?n.splice(l--,1):(o=!1,s<r&&(r=s));if(o){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,a,s]},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,s,r=n[0],o=n[1],l=n[2],u=0;if(r.some((function(t){return 0!==e[t]}))){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(l)var c=l(i)}for(t&&t(n);u<r.length;u++)s=r[u],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(c)},n=self.webpackChunkqsm=self.webpackChunkqsm||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=i.O(void 0,[431],(function(){return i(775)}));a=i.O(a)}();