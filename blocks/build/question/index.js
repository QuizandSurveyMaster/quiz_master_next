!function(){"use strict";var e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.blocks,a=window.wp.element,n=window.wp.i18n,r=window.wp.apiFetch,i=e.n(r),o=window.wp.blockEditor,l=window.wp.notices,s=window.wp.data,c=window.wp.components,m=(window.wp.hooks,window.wp.blob),u=window.wp.coreData;const d=e=>null==e||""===e,p=e=>d(e)||!Array.isArray(e)?e:e.filter(((e,t,a)=>a.indexOf(e)===t)),_=e=>{var t=document.createElement("textarea");return t.innerHTML=e,t.value},g=e=>{let t=document.createElement("div");return t.innerHTML=_(e),t.innerText},h=(e=!1)=>{let t=new FormData;if(t.append("qsm_block_api_call","1"),!1!==e)for(let a in e)e.hasOwnProperty(a)&&t.append(a,e[a]);return t},q=(e,t="")=>d(e)?t:e,f=["image"],E=(0,n.__)("Featured image"),w=(0,n.__)("Set featured image"),x=(0,a.createElement)("p",null,(0,n.__)("To edit the featured image, you need permission to upload media."));var y=({featureImageID:e,onUpdateImage:t,onRemoveImage:r})=>{const{createNotice:i}=(0,s.useDispatch)(l.store),p=(0,a.useRef)(),[_,g]=(0,a.useState)(!1),[h,q]=(0,a.useState)(void 0),{mediaFeature:y,mediaUpload:b}=(0,s.useSelect)((t=>{const{getMedia:a}=t(u.store);return{mediaFeature:d(h)&&!d(e)&&a(e),mediaUpload:t(o.store).getSettings().mediaUpload}}),[]);function v(e){b({allowedTypes:["image"],filesList:e,onFileChange([e]){(0,m.isBlobURL)(e?.url)?g(!0):(t(e),g(!1))},onError(e){i("error",e,{isDismissible:!0,type:"snackbar"})}})}return(0,a.useEffect)((()=>{let t=!0;return t&&(d(y)||"object"!=typeof y||q({id:e,width:y.media_details.width,height:y.media_details.height,url:y.source_url,alt_text:y.alt_text,slug:y.slug})),()=>{t=!1}}),[y]),(0,a.createElement)("div",{className:"editor-post-featured-image"},h&&(0,a.createElement)("div",{id:`editor-post-featured-image-${e}-describedby`,className:"hidden"},h.alt_text&&(0,n.sprintf)(
// Translators: %s: The selected image alt text.
(0,n.__)("Current image: %s"),h.alt_text),!h.alt_text&&(0,n.sprintf)(
// Translators: %s: The selected image filename.
(0,n.__)("The current image has no alternative text. The file name is: %s"),h.slug)),(0,a.createElement)(o.MediaUploadCheck,{fallback:x},(0,a.createElement)(o.MediaUpload,{title:E,onSelect:e=>{q(e),t(e)},unstableFeaturedImageFlow:!0,allowedTypes:f,modalClass:"editor-post-featured-image__media-modal",render:({open:t})=>(0,a.createElement)("div",{className:"editor-post-featured-image__container"},(0,a.createElement)(c.Button,{ref:p,className:e?"editor-post-featured-image__preview":"editor-post-featured-image__toggle",onClick:t,"aria-label":e?(0,n.__)("Edit or replace the image"):null,"aria-describedby":e?`editor-post-featured-image-${e}-describedby`:null},!!e&&h&&(0,a.createElement)(c.ResponsiveWrapper,{naturalWidth:h.width,naturalHeight:h.height,isInline:!0},(0,a.createElement)("img",{src:h.url,alt:h.alt_text})),_&&(0,a.createElement)(c.Spinner,null),!e&&!_&&w),!!e&&(0,a.createElement)(c.__experimentalHStack,{className:"editor-post-featured-image__actions"},(0,a.createElement)(c.Button,{className:"editor-post-featured-image__action",onClick:t,"aria-hidden":"true"},(0,n.__)("Replace")),(0,a.createElement)(c.Button,{className:"editor-post-featured-image__action",onClick:()=>{r(),p.current.focus()}},(0,n.__)("Remove"))),(0,a.createElement)(c.DropZone,{onFilesDrop:v})),value:e})))},b=({isCategorySelected:e,setUnsetCatgory:t})=>{const[r,o]=(0,a.useState)(!1),[l,s]=(0,a.useState)(""),[m,u]=(0,a.useState)(0),[p,_]=(0,a.useState)(!1),[g,q]=(0,a.useState)(!1),[f,E]=(0,a.useState)(qsmBlockData?.hierarchicalCategoryList),w=e=>{let t={};return e.forEach((e=>{if(t[e.id]=e,0<e.children.length){let a=w(e.children);t={...t,...a}}})),t},[x,y]=(0,a.useState)(d(qsmBlockData?.hierarchicalCategoryList)?{}:w(qsmBlockData.hierarchicalCategoryList)),b=(0,n.__)("Add New Category ","quiz-master-next"),v=`— ${(0,n.__)("Parent Category ","quiz-master-next")} —`,C=e=>{let t=[];return e.forEach((e=>{if(t.push(e.name),0<e.children.length){let a=C(e.children);t=[...t,...a]}})),t},k=n=>n.map((n=>(0,a.createElement)("div",{key:n.id,className:"editor-post-taxonomies__hierarchical-terms-choice"},(0,a.createElement)(c.CheckboxControl,{label:n.name,checked:e(n.id),onChange:()=>t(n.id,x)}),!!n.children.length&&(0,a.createElement)("div",{className:"editor-post-taxonomies__hierarchical-terms-subchoices"},k(n.children)))));return(0,a.createElement)(c.PanelBody,{title:(0,n.__)("Categories","quiz-master-next"),initialOpen:!0},(0,a.createElement)("div",{className:"editor-post-taxonomies__hierarchical-terms-list",tabIndex:"0",role:"group","aria-label":(0,n.__)("Categories","quiz-master-next")},k(f)),(0,a.createElement)("div",{className:"qsm-ptb-1"},(0,a.createElement)(c.Button,{variant:"link",onClick:()=>o(!r)},b)),r&&(0,a.createElement)("form",{onSubmit:async e=>{e.preventDefault(),g||d(l)||p||(_(!0),i()({url:qsmBlockData.ajax_url,method:"POST",body:h({action:"save_new_category",name:l,parent:m})}).then((e=>{if(!d(e.term_id)){let a=e.term_id;i()({path:"/quiz-survey-master/v1/quiz/hierarchical-category-list",method:"POST"}).then((e=>{"success"==e.status&&(E(e.result),y(e.result),s(""),u(0),t(a,w(term.id)),_(!1))}))}})))}},(0,a.createElement)(c.Flex,{direction:"column",gap:"1"},(0,a.createElement)(c.TextControl,{__nextHasNoMarginBottom:!0,className:"editor-post-taxonomies__hierarchical-terms-input",label:(0,n.__)("Category Name","quiz-master-next"),value:l,onChange:e=>((e,t)=>{t=C(t),console.log("categories",t),t.includes(e)?q(e):(q(!1),s(e))})(e,f),required:!0}),0<f.length&&(0,a.createElement)(c.TreeSelect,{__nextHasNoMarginBottom:!0,label:(0,n.__)("Parent Category","quiz-master-next"),noOptionLabel:v,onChange:e=>u(e),selectedId:m,tree:f}),(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(c.Button,{variant:"secondary",type:"submit",className:"editor-post-taxonomies__hierarchical-terms-submit",disabled:g||p},b)),(0,a.createElement)(c.FlexItem,null,(0,a.createElement)("p",{className:"qsm-error-text"},!1!==g&&(0,n.__)("Category ","quiz-master-next")+g+(0,n.__)(" already exists.","quiz-master-next"))))))},v=JSON.parse('{"u2":"qsm/quiz-question"}');(0,t.registerBlockType)(v.u2,{icon:()=>(0,a.createElement)(c.Icon,{icon:()=>(0,a.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("rect",{width:"24",height:"24",rx:"3",fill:"#EEEEEE"}),(0,a.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.4286 17.5056C15.5786 17.0551 18 14.346 18 11.0714C18 7.48159 15.0899 4.57144 11.5 4.57144C7.91015 4.57144 5 7.48159 5 11.0714C5 14.346 7.42144 17.0551 10.5714 17.5056V15.9527C8.27155 15.5178 6.53214 13.4978 6.53214 11.0714C6.53214 8.32777 8.75633 6.10359 11.5 6.10359C14.2437 6.10359 16.4679 8.32777 16.4679 11.0714C16.4679 13.4978 14.7285 15.5178 12.4286 15.9527V17.5056Z",fill:"black"}),(0,a.createElement)("rect",{x:"11.5",y:"14.1667",width:"1.70238",height:"5.26191",fill:"black"}))}),edit:function(e){if("undefined"==typeof qsmBlockData)return null;const{className:t,attributes:r,setAttributes:m,isSelected:u,clientId:f,context:E}=e,w=(0,s.useSelect)((e=>u||e("core/block-editor").hasSelectedInnerBlock(f,!0))),x=E["quiz-master-next/quizID"],{quiz_name:v,post_id:C,rest_nonce:k}=E["quiz-master-next/quizAttr"],{createNotice:I}=(E["quiz-master-next/pageID"],(0,s.useDispatch)(l.store)),{isChanged:B=!1,questionID:D,type:z,description:N,title:S,correctAnswerInfo:T,commentBox:F,category:P,multicategories:A=[],hint:M,featureImageID:O,featureImageSrc:R,answers:U,answerEditor:H,matchAnswer:L,required:Q}=r,j="1"==qsmBlockData.is_pro_activated,W=e=>14<parseInt(e);(0,a.useEffect)((()=>{let e=!0;if(e&&(d(D)||"0"==D||!d(D)&&((e,t)=>{const a=(0,s.select)("core/block-editor").getClientIdsWithDescendants();return!d(a)&&a.some((a=>{const{questionID:n}=(0,s.select)("core/block-editor").getBlockAttributes(a);return t!==a&&n===e}))})(D,f))){let e=h({id:null,rest_nonce:k,quizID:x,quiz_name:v,postID:C,answerEditor:q(H,"text"),type:q(z,"0"),name:_(q(N)),question_title:q(S),answerInfo:_(q(T)),comments:q(F,"1"),hint:q(M),category:q(P),multicategories:[],required:q(Q,1),answers:U,page:0,featureImageID:O,featureImageSrc:R,matchAnswer:null});i()({path:"/quiz-survey-master/v1/questions",method:"POST",body:e}).then((e=>{if("success"==e.status){let t=e.id;m({questionID:t})}})).catch((e=>{console.log("error",e),I("error",e.message,{isDismissible:!0,type:"snackbar"})}))}return()=>{e=!1}}),[]),(0,a.useEffect)((()=>{let e=!0;return e&&u&&!1===B&&m({isChanged:!0}),()=>{e=!1}}),[D,z,N,S,T,F,P,A,M,O,R,U,H,L,Q]);const $=(0,o.useBlockProps)({className:w?" in-editing-mode":""}),V=(e,t)=>{let a=[];if(!d(t[e])&&"0"!=t[e].parent&&(e=t[e].parent,a.push(e),!d(t[e])&&"0"!=t[e].parent)){let n=V(e,t);a=[...a,...n]}return p(a)},Z=["12","7","3","5","14"].includes(z)?(0,n.__)("Note: Add only correct answer options with their respective points score.","quiz-master-next"):"";return W(z)?(0,a.createElement)(a.Fragment,null,(0,a.createElement)(o.InspectorControls,null,(0,a.createElement)(c.PanelBody,{title:(0,n.__)("Question settings","quiz-master-next"),initialOpen:!0},(0,a.createElement)("h2",{className:"block-editor-block-card__title"},(0,n.__)("ID","quiz-master-next")+": "+D),(0,a.createElement)("h3",null,(0,n.__)("Advanced Question Type","quiz-master-next")))),(0,a.createElement)("div",{...$},(0,a.createElement)("h4",{className:"qsm-question-title qsm-error-text"},(0,n.__)("Advanced Question Type : ","quiz-master-next")+S))):(0,a.createElement)(a.Fragment,null,(0,a.createElement)(o.InspectorControls,null,(0,a.createElement)(c.PanelBody,{title:(0,n.__)("Question settings","quiz-master-next"),initialOpen:!0},(0,a.createElement)("h2",{className:"block-editor-block-card__title"},(0,n.__)("ID","quiz-master-next")+": "+D),(0,a.createElement)(c.SelectControl,{label:qsmBlockData.question_type.label,value:z||qsmBlockData.question_type.default,onChange:e=>(e=>{if(d(MicroModal)||j||!["15","16","17"].includes(e))m({type:e});else{let e=document.getElementById("modal-advanced-question-type");d(e)||MicroModal.show("modal-advanced-question-type")}})(e),help:d(qsmBlockData.question_type_description[z])?"":qsmBlockData.question_type_description[z]+" "+Z,__nextHasNoMarginBottom:!0},!d(qsmBlockData.question_type.options)&&qsmBlockData.question_type.options.map((e=>(0,a.createElement)("optgroup",{label:e.category,key:"qtypes"+e.category},e.types.map((e=>(0,a.createElement)("option",{value:e.slug,key:"qtype"+e.slug,disabled:j&&W(e.slug)},e.name))))))),["0","4","1","10","13"].includes(z)&&(0,a.createElement)(c.SelectControl,{label:qsmBlockData.answerEditor.label,value:H||qsmBlockData.answerEditor.default,options:qsmBlockData.answerEditor.options,onChange:e=>m({answerEditor:e}),__nextHasNoMarginBottom:!0}),(0,a.createElement)(c.ToggleControl,{label:(0,n.__)("Required","quiz-master-next"),checked:!d(Q)&&"1"==Q,onChange:()=>m({required:d(Q)||"1"!=Q?1:0})})),(0,a.createElement)(b,{isCategorySelected:e=>A.includes(e),setUnsetCatgory:(e,t)=>{let a=d(A)||0===A.length?d(P)?[]:[P]:A;if(a.includes(e))a=a.filter((t=>t!=e)),a.forEach((n=>{V(n,t).includes(e)&&(a=a.filter((e=>e!=n)))}));else{a.push(e);let n=V(e,t);a=[...a,...n]}a=p(a),m({category:"",multicategories:[...a]})}}),(0,a.createElement)(c.PanelBody,{title:(0,n.__)("Featured image","quiz-master-next"),initialOpen:!0},(0,a.createElement)(y,{featureImageID:O,onUpdateImage:e=>{m({featureImageID:e.id,featureImageSrc:e.url})},onRemoveImage:e=>{m({featureImageID:void 0,featureImageSrc:void 0})}})),(0,a.createElement)(c.PanelBody,{title:qsmBlockData.commentBox.heading},(0,a.createElement)(c.SelectControl,{label:qsmBlockData.commentBox.label,value:F||qsmBlockData.commentBox.default,options:qsmBlockData.commentBox.options,onChange:e=>m({commentBox:e}),__nextHasNoMarginBottom:!0}))),(0,a.createElement)("div",{...$},(0,a.createElement)(o.RichText,{tagName:"h4",title:(0,n.__)("Question title","quiz-master-next"),"aria-label":(0,n.__)("Question title","quiz-master-next"),placeholder:(0,n.__)("Type your question here","quiz-master-next"),value:S,onChange:e=>m({title:g(e)}),allowedFormats:[],withoutInteractiveFormatting:!0,className:"qsm-question-title"}),w&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(o.RichText,{tagName:"p",title:(0,n.__)("Question description","quiz-master-next"),"aria-label":(0,n.__)("Question description","quiz-master-next"),placeholder:(0,n.__)("Description goes here","quiz-master-next"),value:_(N),onChange:e=>m({description:e}),className:"qsm-question-description",__unstableEmbedURLOnPaste:!0,__unstableAllowPrefixTransformations:!0}),!["8","11","6","9"].includes(z)&&(0,a.createElement)(o.InnerBlocks,{allowedBlocks:["qsm/quiz-answer-option"],template:[["qsm/quiz-answer-option",{optionID:"0"}],["qsm/quiz-answer-option",{optionID:"1"}]]}),(0,a.createElement)(o.RichText,{tagName:"p",title:(0,n.__)("Correct Answer Info","quiz-master-next"),"aria-label":(0,n.__)("Correct Answer Info","quiz-master-next"),placeholder:(0,n.__)("Correct answer info goes here","quiz-master-next"),value:_(T),onChange:e=>m({correctAnswerInfo:e}),className:"qsm-question-correct-answer-info",__unstableEmbedURLOnPaste:!0,__unstableAllowPrefixTransformations:!0}),(0,a.createElement)(o.RichText,{tagName:"p",title:(0,n.__)("Hint","quiz-master-next"),"aria-label":(0,n.__)("Hint","quiz-master-next"),placeholder:(0,n.__)("hint goes here","quiz-master-next"),value:M,onChange:e=>m({hint:g(e)}),allowedFormats:[],withoutInteractiveFormatting:!0,className:"qsm-question-hint"}))))}})}();